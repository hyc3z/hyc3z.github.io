<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.15">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Hyc3z&#39;s blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Hyc3z&#39;s blog Atom Feed"><title data-react-helmet="true">Spark åŸºç¡€çŸ¥è¯† | Hyc3z&#x27;s blog</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://hyc3z.github.io/docs/big-data/spark"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Spark åŸºç¡€çŸ¥è¯† | Hyc3z&#x27;s blog"><meta data-react-helmet="true" name="description" content="Spark"><meta data-react-helmet="true" property="og:description" content="Spark"><link data-react-helmet="true" rel="icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://hyc3z.github.io/docs/big-data/spark"><link data-react-helmet="true" rel="alternate" href="https://hyc3z.github.io/docs/big-data/spark" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://hyc3z.github.io/docs/big-data/spark" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.98273567.css">
<link rel="preload" href="/assets/js/runtime~main.05a31bdb.js" as="script">
<link rel="preload" href="/assets/js/main.95f6b553.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">Hyc3z&#x27;s blog</b></a><a class="navbar__item navbar__link navbar__link--active" href="/docs/intro">Notes</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/hyc3z" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Hyc3z<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_Pssr toggle_TdHA toggleDisabled_jDku"><div class="toggleTrack_SSoT" role="button" tabindex="-1"><div class="toggleTrackCheck_XobZ"><span class="toggleIcon_eZtF">ğŸŒœ</span></div><div class="toggleTrackX_YkSC"><span class="toggleIcon_eZtF">ğŸŒ</span></div><div class="toggleTrackThumb_uRm4"></div></div><input type="checkbox" class="toggleScreenReader_JnkT" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_P2Lg"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_CW9Y"><nav class="menu thin-scrollbar menu_SkdO"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">intro</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/docs/ai/artificial_intelligence_in_finance">ai</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/docs/cpp/pcal">cpp</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_VCh3" aria-current="page" href="/docs/big-data/hadoop">big-data</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/big-data/hadoop">Hadoop åŸºç¡€çŸ¥è¯†</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/big-data/kafka">Kafka &amp; Zookeeper åŸºç¡€çŸ¥è¯†</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/big-data/spark">Spark åŸºç¡€çŸ¥è¯†</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/docs/blockchain/Chainlink">blockchain</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/docs/cryptography/overview">cryptography</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/docs/data/data_science">data</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/docs/database/Oracle">database</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/docs/design/ddd">design</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/docs/finance/principles_of_economics">finance</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link hasHref_VCh3" href="/docs/git/">git</a><button aria-label="Toggle the collapsible sidebar category &#x27;git&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/docs/graph/graph-database">graph</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/docs/music/Theory">music</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/docs/ts_js/eventloop">ts_js</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/docs/python/re">python</a></div></li></ul></nav></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Spark åŸºç¡€çŸ¥è¯†</h1></header><h4 class="anchor anchorWithStickyNavbar_mojV" id="spark">Spark<a class="hash-link" href="#spark" title="Direct link to heading">â€‹</a></h4><p><img alt="Intermittent iteration of reads and writes between map and reduce computations" src="/assets/images/lesp_0101-644e0335ae96b94ae72cc6f638bc6c7b.png" width="1322" height="206"></p><p>Sparkçš„è¯ç”Ÿï¼ŒæºäºHadoopçš„å‡ ä¸ªé—®é¢˜ï¼š</p><p>1ã€ç®¡ç†è¾ƒéš¾</p><p>è¿™ä¸ªåœ¨å­¦ä¹ Hadoopçš„æ—¶å€™å°±æ„Ÿå—åˆ°äº†ï¼Œä¸€å¤§å †å‚æ•°éœ€è¦è°ƒï¼Œéå¸¸éº»çƒ¦</p><p>2ã€MapReduce API</p><p>éœ€è¦ä¸€å¤§å †æ¨¡æ¿æ–‡ä»¶å’Œä»£ç ï¼Œè€Œä¸”å¼‚å¸¸å¤„ç†å¾ˆéš¾ã€‚</p><p>3ã€ä¸­é—´æ­¥éª¤æœ‰å¤ªå¤šè½ç›˜</p><p>è¯šç„¶ä¿å­˜ä¸­é—´ç»“æœåˆ°ç£ç›˜ï¼Œå¯ä»¥æå‡å¯é æ€§ï¼Œä½†å¤§å¤§é™ä½äº†é€Ÿåº¦å’Œæ€§èƒ½ã€‚</p><p>4ã€éš¾ä»¥é€‚åº”å¤šç§å¤šæ ·çš„æ•°æ®éœ€æ±‚</p><p>å¹¶ä¸æ˜¯æ‰€æœ‰ä»»åŠ¡éƒ½å¯ä»¥æ‹†è§£ä¸ºMapå’ŒReduceï¼Œæœ‰äº›ä»»åŠ¡æ¯”å¦‚AIï¼Œå®ƒå½“ç„¶ä¹Ÿå¯ä»¥ç®—ä½œä¸€ä¸ªReduceï¼Œä½†è¿™ä¸ªReducerè¯¥ä½•å…¶åœ°å¤æ‚ï¼Œæ‰èƒ½å®Œæˆå“ªæ€•ä¸€æ­¥çš„è®¡ç®—ã€‚å¦‚æœæ˜¯AIè®­ç»ƒä»»åŠ¡ç­‰ï¼Œåˆ™æ›´åŠ å›°éš¾ã€‚</p><p>5ã€ç¼ºä¹äº¤äº’æ€§</p><p>æ‰€æœ‰çš„ä»»åŠ¡éƒ½è¢«é¢„å…ˆå¤„ç†å¥½è¿›å…¥Hadoopé›†ç¾¤å¤„ç†ï¼Œç¼ºä¹äº¤äº’æ€§</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="spark-è¯ç”Ÿ">Spark è¯ç”Ÿ<a class="hash-link" href="#spark-è¯ç”Ÿ" title="Direct link to heading">â€‹</a></h5><p>Spark æœ€æ—©ç”±UC Berkeley çš„ä¸€äº›ç ”ç©¶äººå‘˜å¼€å‘ï¼Œä»–ä»¬è®¤ä¸ºMapReduceä¸å¤Ÿæ•ˆç‡ï¼Œè€Œä¸”è¿‡äºå¤æ‚ã€‚æ‰€ä»¥Sparkçš„ç†å¿µå°±æ˜¯ï¼š</p><p>Simplerï¼ŒFaster and Easier</p><p>æ—©æœŸçš„Sparkå°±å·²ç»èƒ½å¤Ÿè¾¾åˆ°Hadoop MapReduce 10~20å€çš„æ€§èƒ½ã€‚</p><p>ä»Šå¤©å·²ç»èƒ½è¾¾åˆ°100å€æ€§èƒ½</p><p>Apache Sparkâ€”a unified computing engine and set of libraries for big data</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="unified">Unified<a class="hash-link" href="#unified" title="Direct link to heading">â€‹</a></h5><p>Sparkè¢«è®¾è®¡ä¸ºæ”¯æŒå„ç§å„æ ·çš„æ•°æ®åˆ†æä»»åŠ¡ï¼Œæ¯”å¦‚ï¼š</p><ul><li>Simple data</li><li>SQL query</li><li>ML/AI</li><li>Streaming computation</li></ul><p>è¿™äº›æ“ä½œéƒ½æ˜¯ä½¿ç”¨åŒä¸€ä¸ªè®¡ç®—å¼•æ“ï¼ŒåŒä¸€å¥—APIã€‚</p><p>Sparkçš„APIå†…éƒ¨è¿˜æœ‰ä¸€äº›ä¼˜åŒ–ï¼Œæ¯”å¦‚å…ˆç”¨SQL queryå–æ•°æ®ï¼Œå†è°ƒç”¨Spark ML Libraryï¼Œ</p><p>Sparkçš„å¼•æ“ä¼šå¯¹è¿™äº›æ­¥éª¤è¿›è¡Œåˆå¹¶ã€ä¼˜åŒ–ï¼Œå‡å°‘è®¿é—®æ•°æ®çš„æ¬¡æ•°æ¥æå‡æ€§èƒ½ã€‚</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="computing-engine">Computing Engine<a class="hash-link" href="#computing-engine" title="Direct link to heading">â€‹</a></h5><p>Sparkçš„å®šä¹‰æ˜ç¡®è¯´æ˜¯ä¸€ä¸ª computing engineï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒæ˜¯ä¸åŒ…æ‹¬æ•°æ®çš„å­˜å‚¨å’Œè½ç›˜çš„éƒ¨åˆ†çš„ã€‚ä½ å¯ä»¥åœ¨Azure Storage, Amazon S3, Hadoop HDFS, Kafka, Cassandraç­‰æ•°æ®è½½ä½“ä¸Šç”¨Sparkï¼Œæ— è®ºæ˜¯æ–‡ä»¶ç³»ç»Ÿï¼Œæ•°æ®åº“è¿˜æ˜¯æ¶ˆæ¯é˜Ÿåˆ—ã€‚</p><p>ç›¸æ¯”ä¹‹ä¸‹ï¼ŒHadoopæ—¢æœ‰è®¡ç®—å¼•æ“ï¼ˆMapReduceï¼‰åˆæœ‰å­˜å‚¨ç³»ç»Ÿï¼ˆHDFSï¼‰ï¼Œä½¿å¾—äºŒè€…ç´§ç´§è€¦åˆï¼Œéš¾ä»¥é€‰æ‹©å…¶ä»–çš„ç³»ç»Ÿï¼ˆè™½ç„¶ç†è®ºä¸ŠHadoopä¹Ÿç¡®å®å¯ä»¥è·‘åœ¨æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿï¼ŒS3ç­‰ä¹‹ä¸Šï¼‰ã€‚</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="libraries">Libraries<a class="hash-link" href="#libraries" title="Direct link to heading">â€‹</a></h5><p>æä¾›ä¸€ä¸ªç»Ÿä¸€çš„APIæ¥å£æ¥å®Œæˆé€šç”¨çš„æ•°æ®åˆ†æä»»åŠ¡ã€‚</p><p>Sparké™¤äº†å†…éƒ¨æ”¯æŒçš„æ ‡å‡†åº“ï¼Œè¿˜æœ‰å¤§é‡ç¬¬ä¸‰æ–¹åº“ã€‚</p><p>ä¸€äº›çŸ¥åçš„Libraryï¼š</p><ul><li>Spark SQL</li><li>MLlib</li><li>Spark Streaming/Structured Streaming</li><li>GraphX</li></ul><h5 class="anchor anchorWithStickyNavbar_mojV" id="spark-application">Spark Application<a class="hash-link" href="#spark-application" title="Direct link to heading">â€‹</a></h5><p>åŒ…å«Driver processå’ŒExecutors</p><p><img alt="image" src="/assets/images/spdg_0201-78b411902419c7fb27042973ee892686.png" width="789" height="539"></p><p><img alt="Spark components communicate through the Spark driver in Sparkâ€™s distributed architecture" src="/assets/images/lesp_0202-c291fe7b2a6597bb49056f64c4bd91c1.png" width="1344" height="725"></p><p>Spark Driverè´Ÿè´£æ§åˆ¶ç”¨æˆ·äº¤äº’å’Œåè°ƒexecutorsä¹‹é—´çš„å·¥ä½œã€‚</p><p>Executorsè´Ÿè´£å…·ä½“è¢«åˆ†é…åˆ°çš„å·¥ä½œã€‚</p><p>æ¯ä¸ªExecutoræ‰§è¡Œçš„ï¼Œå°±æ˜¯Spark Jobã€‚</p><p><img alt="Spark driver creating one or more Spark jobs" src="/assets/images/lesp_0203-325c151502308130ea846aeeb07a9e15.png" width="538" height="363"></p><p>æ¯ä¸ªJobåŒ…å«å¤šä¸ªStageï¼Œæ¯ä¸ªStageåŒ…å«å¤šä¸ªTask</p><p><img alt="Spark stage creating one or more tasks to be distributed to executors" src="/assets/images/lesp_0205-309e3298ad00f0d44c4efbbdf5be5739.png" width="1300" height="369"></p><h5 class="anchor anchorWithStickyNavbar_mojV" id="cluster-mode">Cluster Mode<a class="hash-link" href="#cluster-mode" title="Direct link to heading">â€‹</a></h5><p><img alt="image" src="/assets/images/spdg_1502-d269753ef2f36d3f511fd78dee997476.png" width="603" height="460"></p><p>Cluster Mode æ˜¯æœ€å¸¸è§çš„æäº¤ä»»åŠ¡çš„æ–¹å¼ï¼š</p><p>ç”¨æˆ·æäº¤JAR/Python Script/xx Script -&gt; Cluster manageråœ¨Nodeä¸Šå¯åŠ¨Driver processå’ŒExecutor process</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="client-mode">Client Mode<a class="hash-link" href="#client-mode" title="Direct link to heading">â€‹</a></h5><p><img alt="image" src="/assets/images/spdg_1503-81bbbd5aa6647105e04db6752bcf916d.png" width="669" height="608"></p><p>å’ŒCluster Mode ä¸åŒçš„åœ°æ–¹åœ¨äºï¼ŒClient æ‰€åœ¨çš„æœºå™¨ï¼ˆä¹Ÿå°±æ˜¯ä»»åŠ¡æäº¤çš„æœºå™¨ï¼‰ä¼šç»´æŠ¤driver processï¼Œç„¶åcluster managerç»´æŠ¤executor processã€‚è¿™äº›æœºå™¨ä¹Ÿè¢«ç§°ä¸ºGateway machinesæˆ–Edge nodesï¼Œæ˜¯å¯ä»¥å¤„åœ¨é›†ç¾¤ä¹‹å¤–çš„ã€‚</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="local-mode">Local Mode<a class="hash-link" href="#local-mode" title="Direct link to heading">â€‹</a></h5><p>å­¦ä¹ æ—¶ç”¨ï¼Œåœ¨æœ¬åœ°è¿è¡Œ</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="lifecycle">Lifecycle<a class="hash-link" href="#lifecycle" title="Direct link to heading">â€‹</a></h5><p><img alt="image" src="/assets/images/spdg_1504-6f0730af1791e59be87dbda74927072f.png" width="835" height="608"></p><p>é¦–å…ˆå®¢æˆ·æäº¤ä»»åŠ¡ï¼Œä¸ºSpark Driver Processç”³è¯·èµ„æºã€‚ç„¶åCluster Managerä¼šå°†Driveræ”¾åœ¨é›†ç¾¤ä¸­çš„æŸä¸€ä¸ªnodeä¸Šã€‚Driverå¼€å§‹æ‰§è¡Œä»£ç ï¼Œä»£ç ä¸­åŒ…å«SparkSessionçš„åˆå§‹åŒ–é€»è¾‘ï¼Œä¼šå’Œé›†ç¾¤äº¤äº’æ¥åœ¨èŠ‚ç‚¹ä¸­åˆ†å¸ƒExecutorè¿›ç¨‹ã€‚Driverè´Ÿè´£è°ƒåº¦ï¼ŒWorkerså†…éƒ¨è‡ªä¸»é€šä¿¡ã€‚</p><p>ä¸€ä¸ªSpark JobåŒ…å«å¤šä¸ªStageï¼Œé€šå¸¸Sparkä¼šè¯•ç€è®©åŒä¸€ä¸ªStageæ‰§è¡Œæ›´å¤šçš„ä»»åŠ¡ã€‚é€šå¸¸æ¥è¯´ï¼Œåº”è¯¥è®©ä»»åŠ¡çš„åˆ†åŒºæ•°é‡å¤§äºé›†ç¾¤çš„Executoræ•°é‡ï¼Œæ¥æå‡æ•ˆç‡</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">spark.conf.set(&quot;spark.sql.shuffle.partitions&quot;, 50)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Pipeliningå°±ç›¸å¯¹å¥½ç†è§£ï¼Œæ¯”å¦‚å…ˆæ‰§è¡Œmapï¼Œå†æ‰§è¡Œfilterï¼Œåœ¨æ‰§è¡Œmapï¼Œè¿™ä¸‰ä¸ªæ“ä½œåœ¨Sparkä¸­ä¼šè¢«ä¼˜åŒ–åœ¨ä¸€ä¸ªstageä¸­å®Œæˆï¼Œä¸­é€”ä¸è½ç›˜è€Œæ˜¯åœ¨å†…å­˜ä¸­è®¡ç®—ï¼Œæ¥æå‡æ•ˆç‡ã€‚</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="dataframe">DataFrame<a class="hash-link" href="#dataframe" title="Direct link to heading">â€‹</a></h5><p>DataFrameå°±æ˜¯ä¸€ä¸ªç±»ä¼¼è¡¨æ ¼çš„æ•°æ®ç»“æ„ï¼Œæœ‰åˆ—ä¸è¡Œã€‚</p><p>Sparkçš„DataFrameå’ŒåŸç”Ÿçš„åŒºåˆ«åœ¨äºï¼Œèƒ½å¤Ÿè·¨å¤šä¸ªèŠ‚ç‚¹ï¼Œè€Œä¸æ˜¯åœ¨å•ä¸€èŠ‚ç‚¹ä¸Šã€‚</p><p>å¯ä»¥å°†Pandasçš„dfè½¬ä¸ºSparkçš„df</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="partitions">Partitions<a class="hash-link" href="#partitions" title="Direct link to heading">â€‹</a></h5><p>æ¯ä¸ªPartitionåŒ…å«æ€»æ•°æ®ä¸­çš„è‹¥å¹²è¡Œå­æ•°æ®ï¼Œå­˜åœ¨ä¸€å°ç‰©ç†æœºå™¨ä¸Šã€‚</p><p>å¦‚æœåªæœ‰ä¸€ä¸ªPartitionï¼Œæˆ–è€…åªæœ‰ä¸€ä¸ªExecutorï¼Œéƒ½æ— æ³•å¹¶è¡Œå®Œæˆä»»åŠ¡ï¼Œåªæœ‰å¤šPartitionå¤šExecutoræ‰èƒ½çœŸæ­£å¹¶è¡Œ</p><p>è¿™éƒ¨åˆ†åˆ†åŒºä¸éœ€è¦äººä¸ºæŒ‡å®šï¼Œä½†æ˜¯æœ‰åº•å±‚API</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="transformations">Transformations<a class="hash-link" href="#transformations" title="Direct link to heading">â€‹</a></h4><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain"># in Python</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">divisBy2 = myRange.where(&quot;number % 2 = 0&quot;)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h5 class="anchor anchorWithStickyNavbar_mojV" id="narrow-dependencynarrow-transformation">Narrow dependency(Narrow Transformation)<a class="hash-link" href="#narrow-dependencynarrow-transformation" title="Direct link to heading">â€‹</a></h5><p><img alt="image" src="/assets/images/spdg_0204-2bd800704fe2ff38e1cae57a503b50f6.png" width="435" height="510"></p><p>å¯¹ä»»æ„ä¸€ä¸ªè¾“å…¥ï¼Œåªæœ‰ä¸€ä¸ªè¾“å‡ºï¼Œç§°ä¸ºNarrow Dependencyã€‚å¯¹è¿™æ ·çš„æ“ä½œï¼ŒSparkä¼šè¿›è¡ŒPipeliningï¼Œæ‰€æœ‰æ“ä½œéƒ½åœ¨å†…å­˜ä¸­è¿›è¡Œã€‚</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="wide-dependency">Wide Dependency<a class="hash-link" href="#wide-dependency" title="Direct link to heading">â€‹</a></h5><p><img alt="image" src="/assets/images/spdg_0205-8c3dfa95316513ee42a9f27c9c3c016a.png" width="380" height="510"></p><p>å¯¹Shuffleæ“ä½œï¼ŒSparkä¼šåœ¨é›†ç¾¤å†…éƒ¨äº¤æ¢Partitionï¼Œç»“æœä¼šå†™å…¥ç£ç›˜ã€‚</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="actions">Actions<a class="hash-link" href="#actions" title="Direct link to heading">â€‹</a></h5><ul><li>Actions to view data in the console</li><li>Actions to collect data to native objects in the respective language</li><li>Actions to write to output data sources</li></ul><p>å¦‚ï¼šå–å¾—ä¸€ä¸ªDataFrameçš„è®°å½•æ¡æ•°</p><p><code>divisBy2.count()</code></p><p>ä¸€äº›Transformationå’ŒActionsï¼š</p><table><thead><tr><th align="left">Transformations</th><th align="left">Actions</th></tr></thead><tbody><tr><td align="left"><code>orderBy()</code></td><td align="left"><code>show()</code></td></tr><tr><td align="left"><code>groupBy()</code></td><td align="left"><code>take()</code></td></tr><tr><td align="left"><code>filter()</code></td><td align="left"><code>count()</code></td></tr><tr><td align="left"><code>select()</code></td><td align="left"><code>collect()</code></td></tr><tr><td align="left"><code>join()</code></td><td align="left"><code>save()</code></td></tr></tbody></table><h5 class="anchor anchorWithStickyNavbar_mojV" id="lazy-evaluation">Lazy Evaluation<a class="hash-link" href="#lazy-evaluation" title="Direct link to heading">â€‹</a></h5><p>åœ¨å¯¹æ•°æ®è¿›è¡Œæ“ä½œæ—¶ï¼Œå¹¶ä¸ç«‹å³ä¿®æ”¹ï¼Œè€Œæ˜¯å»ºç«‹ä¸€ä¸ªplanï¼ŒåŒ…å«å¤šä¸ªæ“ä½œã€‚</p><p>ç›´åˆ°æœ€åï¼Œç¼–è¯‘è¿™ä¸ªplanï¼Œç„¶åä¼˜åŒ–åå†ä¸€èµ·æ‰§è¡Œã€‚</p><p>æ¯”å¦‚Predicate Pushdownï¼Œè¿™ç±»åœ¨æ•°æ®åº“ç»å¸¸ç”¨åˆ°çš„ä¼˜åŒ–ï¼Œå°±ä¼šåœ¨è¿™ä¸ªæ—¶å€™åšï¼Œå¤§å¤§åŠ å¿«å¤„ç†é€Ÿåº¦ã€‚</p><p><img alt="Lazy transformations and eager actions" src="/assets/images/lesp_0206-b26e0266a9ab6818ae91bcfa2e9b381c.png" width="1220" height="490"></p><p><img alt="image" src="/assets/images/spdg_0209-8aa6a14ed6dd30fba8d6b7d8f9ca107c.png" width="1087" height="483"></p><p><img alt="image" src="/assets/images/spdg_0401-1490378de6a7cf7df788d80259012684.png" width="1014" height="523"></p><h5 class="anchor anchorWithStickyNavbar_mojV" id="logical-planning-and-physical-planning">Logical Planning and Physical Planning<a class="hash-link" href="#logical-planning-and-physical-planning" title="Direct link to heading">â€‹</a></h5><p><img alt="image" src="/assets/images/spdg_0402-3baad4b3fdfeb2daa132e6ca4aab80bd.png" width="1250" height="343"></p><p><img alt="image" src="/assets/images/spdg_0403-582bc7da18e81d77923a495225f51b53.png" width="1367" height="449"></p><h4 class="anchor anchorWithStickyNavbar_mojV" id="rdd">RDD<a class="hash-link" href="#rdd" title="Direct link to heading">â€‹</a></h4><p><img alt="image-20220902090236235" src="/assets/images/image-20220902090236235-6e9eb6bc8a6f1b627afc25ab86e1a262.png" width="1452" height="628"></p><p>å‚è€ƒnsdi12-final138.pdf</p><p>In short, an RDD represents an immutable, partitioned collection of records that can be operated on in parallel. Unlike DataFrames though, where each record is a structured row containing fields with a known schema, in RDDs the records are just Java, Scala, or Python objects of the programmerâ€™s choosing.</p><p>High Level APIï¼š</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">from pyspark.sql import SparkSession</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from pyspark.sql.functions import avg</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Create a DataFrame using SparkSession</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spark = (SparkSession</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  .builder</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  .appName(&quot;AuthorsAges&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  .getOrCreate())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Create a DataFrame </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">data_df = spark.createDataFrame([(&quot;Brooke&quot;, 20), (&quot;Denny&quot;, 31), (&quot;Jules&quot;, 30), </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (&quot;TD&quot;, 35), (&quot;Brooke&quot;, 25)], [&quot;name&quot;, &quot;age&quot;])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Group the same names together, aggregate their ages, and compute an average</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">avg_df = data_df.groupBy(&quot;name&quot;).agg(avg(&quot;age&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Show the results of the final execution</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">avg_df.show()</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>å¯¹åº”çš„Low Level RDDæ“ä½œï¼š</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain"># Create an RDD of tuples (name, age)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dataRDD = sc.parallelize([(&quot;Brooke&quot;, 20), (&quot;Denny&quot;, 31), (&quot;Jules&quot;, 30), </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  (&quot;TD&quot;, 35), (&quot;Brooke&quot;, 25)])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Use map and reduceByKey transformations with their lambda </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># expressions to aggregate and then compute average</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">agesRDD = (dataRDD</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  .map(lambda x: (x[0], (x[1], 1)))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  .reduceByKey(lambda x, y: (x[0] + y[0], x[1] + y[1]))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  .map(lambda x: (x[0], x[1][0]/x[1][1])))</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>åˆ›å»ºRDD</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">spark.range(10).rdd</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h5 class="anchor anchorWithStickyNavbar_mojV" id="æ•°æ®ç±»å‹">æ•°æ®ç±»å‹<a class="hash-link" href="#æ•°æ®ç±»å‹" title="Direct link to heading">â€‹</a></h5><table><thead><tr><th align="left">Data type</th><th align="left">Value assigned in Scala</th><th align="left">API to instantiate</th></tr></thead><tbody><tr><td align="left"><code>ByteType</code></td><td align="left"><code>Byte</code></td><td align="left"><code>DataTypes.ByteType</code></td></tr><tr><td align="left"><code>ShortType</code></td><td align="left"><code>Short</code></td><td align="left"><code>DataTypes.ShortType</code></td></tr><tr><td align="left"><code>IntegerType</code></td><td align="left"><code>Int</code></td><td align="left"><code>DataTypes.IntegerType</code></td></tr><tr><td align="left"><code>LongType</code></td><td align="left"><code>Long</code></td><td align="left"><code>DataTypes.LongType</code></td></tr><tr><td align="left"><code>FloatType</code></td><td align="left"><code>Float</code></td><td align="left"><code>DataTypes.FloatType</code></td></tr><tr><td align="left"><code>DoubleType</code></td><td align="left"><code>Double</code></td><td align="left"><code>DataTypes.DoubleType</code></td></tr><tr><td align="left"><code>StringType</code></td><td align="left"><code>String</code></td><td align="left"><code>DataTypes.StringType</code></td></tr><tr><td align="left"><code>BooleanType</code></td><td align="left"><code>Boolean</code></td><td align="left"><code>DataTypes.BooleanType</code></td></tr><tr><td align="left"><code>DecimalType</code></td><td align="left"><code>java.math.BigDecimal</code></td><td align="left"><code>DecimalType</code></td></tr></tbody></table><table><thead><tr><th align="left">Data type</th><th align="left">Value assigned in Python</th><th align="left">API to instantiate</th></tr></thead><tbody><tr><td align="left"><code>BinaryType</code></td><td align="left"><code>bytearray</code></td><td align="left"><code>BinaryType()</code></td></tr><tr><td align="left"><code>TimestampType</code></td><td align="left"><code>datetime.datetime</code></td><td align="left"><code>TimestampType()</code></td></tr><tr><td align="left"><code>DateType</code></td><td align="left"><code>datetime.date</code></td><td align="left"><code>DateType()</code></td></tr><tr><td align="left"><code>ArrayType</code></td><td align="left">List, tuple, or array</td><td align="left"><code>ArrayType(dataType, [nullable])</code></td></tr><tr><td align="left"><code>MapType</code></td><td align="left"><code>dict</code></td><td align="left"><code>MapType(keyType, valueType, [nullable])</code></td></tr><tr><td align="left"><code>StructType</code></td><td align="left">List or tuple</td><td align="left"><code>StructType([fields])</code></td></tr><tr><td align="left"><code>StructField</code></td><td align="left">A value type corresponding to the type of this field</td><td align="left"><code>StructField(name, dataType, [nullable])</code></td></tr></tbody></table><h5 class="anchor anchorWithStickyNavbar_mojV" id="spark-sql">Spark SQL<a class="hash-link" href="#spark-sql" title="Direct link to heading">â€‹</a></h5><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">spark.read.json(&quot;/data/flight-data/json/2015-summary.json&quot;)\</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  .createOrReplaceTempView(&quot;some_sql_view&quot;) # DF =&gt; SQL</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">spark.sql(&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SELECT DEST_COUNTRY_NAME, sum(count)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">FROM some_sql_view GROUP BY DEST_COUNTRY_NAME</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&quot;&quot;&quot;)\</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  .where(&quot;DEST_COUNTRY_NAME like &#x27;S%&#x27;&quot;).where(&quot;`sum(count)` &gt; 10&quot;)\</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  .count() # SQL =&gt; DF</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p><img alt="When errors are detected using the Structured APIs" src="/assets/images/lesp_0302-da1d1d7e70e476d3a763ebd9973b0e98.png" width="718" height="423"></p><h5 class="anchor anchorWithStickyNavbar_mojV" id="stream-processing">Stream Processing<a class="hash-link" href="#stream-processing" title="Direct link to heading">â€‹</a></h5><p><img alt="Traditional record-at-a-time processing model" src="/assets/images/lesp_0801-994a70bde4841cba56817e8ae5b26da5.png" width="1187" height="690"></p><h5 class="anchor anchorWithStickyNavbar_mojV" id="micro-batchesdstream">Micro Batches(DStream)<a class="hash-link" href="#micro-batchesdstream" title="Direct link to heading">â€‹</a></h5><p><img alt="Structured Streaming uses a micro-batch processing model" src="/assets/images/lesp_0802-57bd392273471943454f74476d516625.png" width="1384" height="515"></p><p>ç§’çº§å»¶è¿Ÿï¼Œä½†å¤§å¤§é™ä½å•æœºå¤„ç†æ•°æ®çš„å¼€é”€</p><p>Incremental Execution</p><p><img alt="The Structured Streaming programming model: data stream as an unbounded table" src="/assets/images/lesp_0803-5862a2a249b3e3f6d5536a93d058c562.png" width="1248" height="565"></p><p><img alt="Incremental execution of streaming queries" src="/assets/images/lesp_0805-9ade2b02592cbea1176348dbd309b2e7.png" width="1440" height="743"></p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain"># In Python</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">inputDF = (spark</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  .readStream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  .format(&quot;kafka&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  .option(&quot;kafka.bootstrap.servers&quot;, &quot;host1:port1,host2:port2&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  .option(&quot;subscribe&quot;, &quot;events&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  .load())</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">streamingQuery = (counts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  .selectExpr(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;cast(word as string) as key&quot;, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;cast(count as string) as value&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  .writeStream</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  .format(&quot;kafka&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  .option(&quot;kafka.bootstrap.servers&quot;, &quot;host1:port1,host2:port2&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  .option(&quot;topic&quot;, &quot;wordCounts&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  .outputMode(&quot;update&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  .option(&quot;checkpointLocation&quot;, checkpointDir)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  .start())</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h5 class="anchor anchorWithStickyNavbar_mojV" id="æ€§èƒ½ä¼˜åŒ–">æ€§èƒ½ä¼˜åŒ–<a class="hash-link" href="#æ€§èƒ½ä¼˜åŒ–" title="Direct link to heading">â€‹</a></h5><p>æ€»ä½“æ¥è¯´ï¼Œæ–‡ä»¶æœ€å¥½ä½¿ç”¨äºŒè¿›åˆ¶æ ¼å¼å­˜å‚¨ï¼Œè€Œä¸æ˜¯csvæ ¼å¼ï¼Œå› ä¸ºæ–‡ä»¶æœ€å¥½èƒ½å¤Ÿè¢«Splitæˆå¤šä¸ªåˆ†å—æ¥è®©ä¸åŒçš„è¿›ç¨‹è¯»å–ã€‚è¿™ä¹Ÿç‰µå‡ºäº†ä¹‹å‰Hadoopé‡åˆ°çš„åŒæ ·é—®é¢˜ï¼Œå¯åˆ†å‰²å‹ç¼©æ ¼å¼ã€‚Zipå°±æ˜¯ä¸€ä¸ªå…¸å‹çš„æ— æ³•åˆ†å‰²çš„å‹ç¼©æ ¼å¼ï¼Œä½¿ç”¨Zipæ ¼å¼æ„å‘³ç€åªæœ‰ä¸€ä¸ªè¿›ç¨‹èƒ½ä»å¤´åˆ°å°¾è¯»å–å®ƒçš„æ•°æ®ï¼Œä¸èƒ½ä»ä¸­åˆ†æ®µè¯»å–ã€‚ç›¸å¯¹æ¥è¯´ï¼Œgz, bz2, lz4å°±éƒ½æœ‰åŠæ³•å¯ä»¥åˆ†å‰²ï¼Œæå‡è¯»å–æ•ˆç‡ã€‚</p><p>é¿å…UDFï¼ˆUser-Defined Functionsï¼‰ï¼Œå°¤å…¶æ˜¯åœ¨Pythonå’ŒRè¯­è¨€ä¸­ï¼Œè„šæœ¬è¯­è¨€æœ¬èº«è§£æé€Ÿåº¦å°±æœ‰é™ï¼Œå°½é‡ä½¿ç”¨Structure API</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="stream-processing-1">Stream Processing<a class="hash-link" href="#stream-processing-1" title="Direct link to heading">â€‹</a></h5><p>ä¼˜åŠ¿ï¼š</p><p>ä½å»¶è¿Ÿï¼Œå¢é‡æ›´æ–°ç»“æœï¼Œé«˜æ•ˆç‡ï¼ˆä¸Batch processing ç›¸æ¯”ï¼‰</p><p>æŒ‘æˆ˜ï¼š</p><p>ä¹±åºæ•°æ®</p><p>å¤æ‚çŠ¶æ€</p><p>é«˜åå</p><p>Exact once</p><p>ä½å»¶è¿Ÿ</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="structured-streaming">Structured Streaming<a class="hash-link" href="#structured-streaming" title="Direct link to heading">â€‹</a></h5><p>Structured streamingçš„ç›®çš„åœ¨äºå¤ç”¨å·²æœ‰çš„Batch APIï¼ˆDataFrame, Dataset, SQLï¼‰ï¼Œå®ƒå°†æ¯ä¸€æ¡æ–°æ•°æ®å½“ä½œè¡¨ä¸­çš„ä¸€æ¡æ–°çºªå½•ã€‚</p><p><img alt="image" src="/assets/images/spdg_2101-ef115015d57e5debbbd4a23070648df9.png" width="1182" height="482"></p><p>ä»Inputè¯»å–æ•°æ®ï¼Œç„¶åå†™åˆ°Sinkä¸­ã€‚</p><p>æœ€å…¸å‹çš„æ•°æ®å­˜å–æºå°±æ˜¯Apache Kafkaã€‚</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="å®‰è£…">å®‰è£…<a class="hash-link" href="#å®‰è£…" title="Direct link to heading">â€‹</a></h4><p><code>brew install scala</code></p><p><code>brew install apache-spark</code></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/big-data/spark.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_foO9"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/big-data/kafka"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Kafka &amp; Zookeeper åŸºç¡€çŸ¥è¯†</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/blockchain/Chainlink"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Chainlink</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"></div></div></div></div></main></div></div></div>
<script src="/assets/js/runtime~main.05a31bdb.js"></script>
<script src="/assets/js/main.95f6b553.js"></script>
</body>
</html>